"use strict";define(["utils/muiview","utils/muiajax"],function(e,n){var t={};return t.choose=function(n,i){var o=[{title:"录像"},{title:"选择视频文件"}];e.osplus()?plus.nativeUI.actionSheet({cancel:"取消",buttons:o},function(e){switch(e.index){case 1:t.byCamera(n,i);break;case 2:t.byGallery(n,i);break;default:console.info(e.index)}}):i&&i(0)},t.byCamera=function(e,t){plus.camera.getCamera().startVideoCapture(function(i){plus.io.resolveLocalFileSystemURL(i,function(i){n(i.toLocalURL(),e,t)},function(e){plus.nativeUI.toast("读取录像文件错误："+e.message)})})},t.byGallery=function(e,t){plus.gallery.pick(function(i){n(i,e,t)},function(e){8===e.code&&mui.alert("您可以在“隐私设置”中启用访问","此应用没有权限访问您的录像","好的")},{filter:"video",multiple:!1,system:!1})},t.play=function(n,i){var o=void 0;e.osplus()?(o=t.videoObj=new plus.video.VideoPlayer("videoDom",{src:n}),o.play(),o.requestFullScreen(),o.addEventListener("ended",function(){o.exitFullScreen()},!1),o.addEventListener("fullscreenchange",function(e){e.detail&&!e.detail.fullScreen&&o.exitFullScreen()}),o.addEventListener("error",function(e){i&&i(-1,"视频播放错误")}),i&&i(1)):(o=t.videoObj=document.getElementById("videoDom"),o&&(o.play(),o.onerror=function(e){i&&i(-1,"视频播放错误")},o.onloadedmetadata=function(){i&&i(1)}))},t.stop=function(n){e.osplus()?(t.videoObj.exitFullScreen(),t.videoObj.close()):t.videoObj.pause(),n&&n(1)},t});