"use strict";define(["mui","utils/utils","utils/storage","config/payRequest"],function(e,n,i,s){var o={};return o.alert=function(n){"string"==typeof n&&(n.message=n),n.title=n.title||"提示通知",e.alert(n.message,n.title,"知道了",function(e){n.onClose&&n.onClose()})},o.confirm=function(n){"string"==typeof n&&(n.message=n),n.title=n.title||"操作提示",e.confirm(n.message,n.title,null,function(e){n.onClose&&n.onClose(e.index>0)})},o.toast=function(n){"string"==typeof n&&(n.message=n);var i=2e3;e.toast(n.message||"操作成功",{duration:n.duration||i}),setTimeout(function(){n.onClose&&n.onClose()},n.duration||i)},o.osplus=function(){return e.os.plus},o.previewImage=function(){console.info("previewImage")},o.openWebview=function(i){var s=e.extend({id:"",url:"",styles:{},extras:{},createNew:!1,show:{aniShow:"slide-in-right"}},i);if(o.osplus())e.plusReady(function(){s.curId?plus.webview.getWebviewById(s.curId):plus.webview.currentWebview();e.openWindow(s);var n=plus.webview.getWebviewById(s.id);n&&(s.reload&&n.reload(),e.fire(n,"show",{}))});else{var t="";s.extras&&(t="?"+n.codeParam(s.extras)),window.top.location.href=n.setpathname(s.url)+t}},o.subWebview=function(i){var s=i.url;if(!o.osplus()){var t="";i.extras&&(t=(n.setpathname(s).indexOf("?")>-1?"&":"?")+n.codeParam(i.extras)),s+=t}e.init({subpages:[{url:s,id:i.id,extras:i.extras,styles:i.styles}]})},o.webviewParams=function(i){if(o.osplus())e.plusReady(function(){var e=plus.webview.currentWebview();i&&i(e)});else{var s=n.getUrlParam();i&&i(s)}},o.curHref=function(){return o.osplus()?plus.webview.currentWebview().getURL():window.location.href},o.scrollY=function(n){e(n).scroll({scrollY:!0,scrollX:!1,startX:0,startY:0,indicators:!0,deceleration:6e-4,bounce:!0})},o.scrollX=function(n,i){e(n).scroll({scrollY:!1,scrollX:!0,indicators:!1,stopPropagation:!0,deceleration:6e-4,snap:i})},o.pullRefresh=function(n,i,s){var t=function(){var o={container:n};i&&(o.up={contentrefresh:"正在加载...",contentnomore:"别扯啦，到底了",callback:i}),s&&(o.down={height:50,contentdown:"下拉可以刷新",contentover:"释放立即刷新",contentrefresh:"正在刷新...",callback:s}),e.init({pullRefresh:o})};o.osplus()?e.plusReady(function(){t()}):t()},o.request=function(e,n,i){o.osplus()?plus.payment.request(e.channel,n,function(n){e.success&&e.success(n),i&&i(1)},function(n){console.error("fail"),e.fail&&e.fail(n),i&&i(-1)}):(e.success&&e.success(s[e.channel.id]),i&&i(1))},o.loading={waiting:null,show:function(){if(o.loading.isWaiting())return!1;if(o.osplus())o.loading.waiting=plus.nativeUI.showWaiting();else{var e=document.createElement("span");e.className="loading-container iconfont icon-loading",e.id="loading-spinner",document.body.appendChild(e),o.loading.waiting=e}},isWaiting:function(){return!!o.loading.waiting},close:function(){o.loading.isWaiting()&&(o.osplus()?(o.loading.waiting.close(),o.loading.waiting=null):(document.body.removeChild(o.loading.waiting),o.loading.waiting=null))}},o.btnloading={show:function(n){var i=e(n.target);i.button("loading")},close:function(n){var i=e(n.target);i.button("reset")}},o.webviewGroup=function(e,i){return o.osplus()?new webviewGroup(e,i):{switchTab:function(e,s){if(window.frames&&window.frames[0]){var t=window.location.href.split("?")[0]+"?"+n.codeParam(s);window.location.href=t}else i.items[0].extras=s,o.subWebview(i.items[0])}}},o.webviewPage=function(n,i){o.osplus()?e.plusReady(function(){i&&i(plus.webview.getWebviewById(n))}):i&&i({})},o.fire=function(n,s,t){if(o.osplus())e.plusReady(function(){var i=plus.webview.getWebviewById(n);i&&e.fire(i,s,{data:t})});else{var a={methods:s,pageId:n,data:t};n.indexOf("sub")>-1?window.frames[0].postMessage(a,"*"):i.set("pageParams",a)}},o.addEventListener=function(e,n,s){if(o.osplus())window.addEventListener(e,function(e){s&&s(e.detail.data)});else if(n.indexOf("sub")>-1)window.addEventListener("message",function(i){var o=i.data;return o?void(o.pageId===n&&o.methods===e&&s&&s(o.data)):void(s&&s())});else{var t=i.get("pageParams");t.methods===e&&t.pageId===n?s&&s(t.data):s&&s()}},o.closeWebview=function(n){o.osplus()&&e.plusReady(function(){if(n){var e=plus.webview.getWebviewById(n);e?plus.webview.close(e,"none"):console.error("pageId:"+n+"页面错误")}else{var i=plus.webview.currentWebview();i.close()}})},o.webviewMask=function(e,n){o.osplus()&&plus.webview.create("",e,n).show()},o.back=function(){o.osplus()?e.back():window.history.back()},o.platform=function(){return e.os.android?"android":e.os.ios?"ios":"unknown"},o.copyToClip=function(e){if(o.osplus()){if("ios"===o.platform()){var n=plus.ios.importClass("UIPasteboard"),i=n.generalPasteboard();i.setValueforPasteboardType(e,"public.utf8-plain-text")}else{var s=plus.android.importClass("android.content.Context"),t=plus.android.runtimeMainActivity(),a=t.getSystemService(s.CLIPBOARD_SERVICE);plus.android.invoke(a,"setText",e)}o.toast({message:"复制成功"})}else console.info("复制的内容是",e)},o.closeSplashscreen=function(){o.osplus()&&plus.navigator.closeSplashscreen()},o.setFullscreen=function(e){o.osplus()&&plus.navigator.setFullscreen(e)},o.getVersion=function(n){o.osplus()?e.plusReady(function(){plus.runtime.getProperty(plus.runtime.appid,function(e){n&&n(1,e.version)})}):n&&n(-1)},o});