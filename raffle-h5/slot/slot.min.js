"use strict";!function(t){function e(t,i){this.options={activityClass:"activity-status",grid:3,box_tpl:'<div class="slot-box"><img title="{{liv_title}}" src="{{liv_pic}}" /></div>',machine_tpl:'<div id="slot-{{liv_index}}" class="slot-machine">{{liv_box_li}}</div>'},this.element=$(i),this.resultInfo={},$.extend(this.options,t),this.init()}(e.prototype=new t.Raffle).extraEvent=function(){this.initModal(),this.initSlot()},e.prototype.initSlot=function(){this.renderSlot(),this.mSlot={};for(var o=this,t=0;t<this.options.grid;t++)this.mSlot[t+1]=new SlotMachine($("#slot-"+(t+1))[0],{active:t,delay:500,randomize:function(){if(o.options.data&&o.options.data.rewards){var t=o.options.data.rewards.length,i=Math.floor(Math.random()*(t+1));if(0<o.resultInfo.status)return o.resultInfo.redeemable?o.resultInfo.num:i}return 1}})},e.prototype.renderSlot=function(){var e=this;this.options.data&&this.options.data.rewards&&function(){var n="";e.options.data.rewards.forEach(function(o){n+=e.options.box_tpl.replace(/{{liv_(.*?)}}/g,function(t,i){return t.replace("{{liv_"+i+"}}",o[i]||"")})});for(var t="",i=function(o){t+=e.options.machine_tpl.replace(/{{liv_(.*?)}}/g,function(t,i){return"box_li"===i?t.replace("{{liv_box_li}}",n):"index"===i?t.replace("{{liv_index}}",o+1):t})},o=0;o<e.options.grid;o++)i(o);e.element.find(".slot-area").removeClass("hide").append(t)}()},e.prototype.initReset=function(){var o=this,t=this.limit();if(t)return this.utils.toast({msg:t}),!1;this.lotteryModal(function(t,i){0<(o.resultInfo.status=t)?o.resultInfo=$.extend(o.resultInfo,i):o.utils.toast({msg:i})}),this.element.find(".raffle-reset").removeClass(this.options.activityClass);for(var i=function(i){setTimeout(function(){o.mSlot[i+1].shuffle(5,function(t){i===o.options.grid-1&&o.drawModal(o.resultInfo)})},500*i)},n=0;n<this.options.grid;n++)i(n)},$.fn.slot=function(i){var o=this,n=Array.prototype.slice.call(arguments,1);return this.each(function(){var t=$(o).data("slot");t?t[i].apply(t,n):t=$(o).data("slot",new e(i,o))})}}(window);